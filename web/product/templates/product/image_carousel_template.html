{% load static %}
<style>
    #imgcarousel .list-inline {
        white-space: nowrap;
        /*overflow-x: auto;*/
    }

    #imgcarousel .carousel-indicators {
        position: static;
        left: initial;
        width: initial;
        /*margin-left: initial;*/
    }

    #imgcarousel .carousel-indicators > li {
        width: initial;
        height: initial;
        text-indent: initial;
    }

    #imgcarousel .carousel-indicators > li.active img {
        opacity: 0.7;
    }
</style>

<div id="imgcarousel" class="carousel slide" data-ride="carousel">
    <div class="carousel-inner">
        {% if product.images %}
        {% if product.images.count > 1 %}
        {% for img in product.images.all %}
        <div class="carousel-item{% if forloop.first %} active{% endif %}">
            <img class="img-fluid d-block w-100" src="{{ img.image_538x538.url }}" alt="{{ img.caption }}">
        </div>
        {% endfor %}
        <a class="carousel-control-prev" href="#imgcarousel" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#imgcarousel" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>

        <ol class="carousel-indicators list-inline">
            {% for img in product.images.all %}
            <li data-target="#imgcarousel" data-slide-to="{{ forloop.counter|add:'-1' }}"
                {%if forloop.first %} class="active" {% endif %}>
                <img class="img-fluid d-block w-100" src="{{ img.image_538x538.url }}" alt="{{ img.caption }}">
            </li>
            {% endfor %}
        </ol>
        {% else %}
        <div class="carousel-item active">
            <img class="img-fluid d-block w-100" src="{{ product.images.first.image.url }}" alt="{{ img.caption }}">
        </div>
        {% endif %}

        {% else %}
        <div class="carousel-item active">
            <img class="img-fluid d-block w-100" src="/media/placeholder.png" alt="{{ product.name }}">
        </div>
        {% endif %}
    </div>
</div>